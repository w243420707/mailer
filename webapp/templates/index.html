<!doctype html>
<html lang="zh-cn">
  <head>
    <meta charset="utf-8" />
            </section>
            <section>
              <div class="row">
                <label class="muted">主题覆盖（留空轮询）</label>
                <input id="subject_override" class="input" type="text" placeholder="本次统一主题，可留空" />
              </div>
              <div class="row">
                <label class="muted">邮件内容（HTML）</label>
                <textarea id="body_html" class="textarea" placeholder="<p>您好...</p>\n<!-- 支持 {{email}} / {{index}} / {{domain}} -->"></textarea>
              </div>
            </section>
            <section>
              <div class="toolbar">
                <button id="sendList" class="btn btn-primary" type="button">发送本次列表</button>
                <button id="saveOnly" class="btn btn-ghost" type="button">仅保存</button>
                <button id="sendAll" class="btn btn-success" type="button">发送已累积</button>
              </div>
            </section>
          </div>
        </div>

        <!-- 右列：结果 / 进度 / 收件人 / 原始配置 -->
        <div class="stack">
          <div class="card" id="card-result">
            <h3>发送结果</h3>
            <div class="toolbar">
              <button id="last" class="btn btn-ghost" type="button">获取上次结果</button>
            </div>
            <pre id="result" style="margin-top:12px; max-height:240px;"></pre>
          </div>
          <div class="card" id="card-progress">
            <h3>发送进度</h3>
            <div class="progress"><div id="progBar" class="bar"></div></div>
            <div id="progText" class="muted" style="margin-top:10px;">状态：idle</div>
          </div>
          <div class="card" id="card-recipients">
            <h3>收件人列表 <span class="badge" id="recTotal">0</span></h3>
            <div class="toolbar" style="margin-bottom:8px;">
              <button id="expRec" class="btn btn-ghost" type="button">导出</button>
              <button id="clearRec" class="btn btn-danger" type="button">清空</button>
            </div>
            <pre id="recPreview" style="max-height:220px;"></pre>
          </div>
          <div class="card" id="card-config-json">
            <h3>原始配置 JSON</h3>
            <details open>
              <summary class="muted" style="cursor:pointer;">折叠/展开</summary>
              <pre id="config" style="margin-top:12px; max-height:260px;"></pre>
            </details>
          </div>
          <div class="footer-note">Mailer UI · 简化批量发送流程</div>
        </div>
      </div>
    </div>

    <div>
      <h3>发送结果</h3>
      <button id="last">获取上次结果</button>
      <pre id="result"></pre>
    </div>

    <hr/>
    <div>
      <h3>粘贴收件人列表发送（支持去重）</h3>
      <div style="max-width: 800px;">
        <label>
          收件人（换行/逗号/分号分隔）
          <textarea id="recipients_text" rows="8" style="width:100%;" placeholder="a@example.com\nb@example.com\nc@example.com"></textarea>
        </label>
        <div style="margin:6px 0;">
          <label><input id="dedupe" type="checkbox" checked /> 去重</label>
        </div>
        <label>
          主题（留空则使用配置中的 subject）
          <input id="subject_override" type="text" style="width:100%;" />
        </label>
        <label>
          邮件内容（HTML）
          <textarea id="body_html" rows="10" style="width:100%;" placeholder="<p>您好...</p>"></textarea>
          <small>支持占位：{{email}}、{{index}}、{{domain}}</small>
        </label>
        <div style="margin-top:8px;">
          <button id="sendList">发送粘贴列表（后台）</button>
          <button id="saveOnly" type="button">仅保存不发送</button>
          <button id="sendAll" type="button">对已累积收件人发送</button>
        </div>
      </div>
    </div>

    <hr/>
    <div>
      <h3>收件人列表（recipients.txt）</h3>
      <div>
        <span>总数：<b id="recTotal">0</b></span>
        <button id="expRec">导出</button>
        <button id="clearRec">清空</button>
      </div>
      <pre id="recPreview" style="max-height: 200px; overflow:auto; background:#f7f7f7; padding:8px;"></pre>
    </div>

    <hr/>
    <div>
      <h3>发送进度</h3>
      <div style="width:100%;max-width:600px;background:#eee;height:16px;border-radius:8px;overflow:hidden;">
        <div id="progBar" style="width:0%;height:100%;background:#4caf50;"></div>
      </div>
      <div id="progText" style="margin-top:6px;color:#333;">状态：idle</div>
    </div>
    <details>
      <summary>查看原始配置 JSON</summary>
      <pre id="config">加载中...</pre>
    </details>

    <script src="/static/main.js"></script>
  </body>
</html>
