<!doctype html>
<html lang="zh-cn">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Mailer 配置管理</title>
  </head>
  <body>
    <h2>Mailer 配置管理</h2>
    <div>
      <h3>编辑配置</h3>
      <form id="cfgForm" onsubmit="return false;" style="max-width: 700px;">
        <fieldset>
          <legend>Postal</legend>
          <label>
            面板地址(server):
            <input id="postal.server" type="text" placeholder="https://your-postal" style="width:100%" />
          </label>
          <br/>
          <label>
            API Key:
            <input id="postal.key" type="password" placeholder="API Key" style="width:100%" />
          </label>
          <div>
            <h3>发送结果</h3>
            <button id="last">获取上次结果</button>
            <pre id="result"></pre>
          </div>
        <fieldset>
          <legend>Setting</legend>
          <label>
            Excel 文件(excel_file):
            <input id="setting.excel_file" type="text" style="width:100%" disabled />
          </label>
          <br/>
          <label>
            主题(subject):
            <input id="setting.subject" type="text" style="width:100%" />
          </label>
          <br/>
          <label>
            代理(proxy):
            <input id="setting.proxy" type="text" placeholder="http://ip:port" style="width:100%" />
          </label>
        </fieldset>

        <div style="margin-top:10px;">
          <button id="save">保存配置</button>
          <button id="refresh" type="button">刷新配置</button>
          <span id="saveMsg" style="margin-left:10px;color:green;"></span>
        </div>
      </form>
    </div>

    <div>
      <h3>上传 Excel</h3>
      <input type="file" id="file" />
      <button id="upload">上传</button>
    </div>

    <div>
      <h3>发送控制</h3>
      <button id="send">开始发送（后台）</button>
      <button id="last">获取上次结果</button>
      <pre id="result"></pre>
    </div>

    <hr/>
    <div>
      <h3>粘贴收件人列表发送（支持去重）</h3>
      <div style="max-width: 800px;">
        <label>
          收件人（换行/逗号/分号分隔）
          <textarea id="recipients_text" rows="8" style="width:100%;" placeholder="a@example.com\nb@example.com\nc@example.com"></textarea>
        </label>
        <div style="margin:6px 0;">
          <label><input id="dedupe" type="checkbox" checked /> 去重</label>
        </div>
        <label>
          主题（留空则使用配置中的 subject）
          <input id="subject_override" type="text" style="width:100%;" />
        </label>
        <label>
          邮件内容（HTML）
          <textarea id="body_html" rows="10" style="width:100%;" placeholder="<p>您好...</p>"></textarea>
        </label>
        <div style="margin-top:8px;">
          <button id="sendList">发送粘贴列表（后台）</button>
        </div>
      </div>
    </div>

    <hr/>
    <details>
      <summary>查看原始配置 JSON</summary>
      <pre id="config">加载中...</pre>
    </details>

    <script src="/static/main.js"></script>
  </body>
</html>
